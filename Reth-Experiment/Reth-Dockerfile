FROM ghcr.io/paradigmxyz/reth:latest

# Set working directory
WORKDIR /app

# Create data directory
RUN mkdir -p /data/reth

# Expose ports
# 30303 - P2P networking (TCP and UDP)
# 8545 - HTTP RPC
# 8551 - Engine API (for Prysm communication)
EXPOSE 30303/tcp 30303/udp 8545 8551

# Set data directory environment variable
ENV RETH_DATADIR=/data/reth

# Default command for mainnet with RPC access
# --http: Enable HTTP RPC server
# --http.addr=0.0.0.0: Listen on all interfaces
# --http.api: Enable APIs (eth, net, web3, engine, admin)
# --authrpc.addr: Engine API address (for Prysm)
# --authrpc.port: Engine API port
# Note: JWT secret will be auto-generated at /data/reth/jwt.hex if not specified
# --datadir: Data directory for blockchain data
# Logging: Handled by Docker's logging driver (configured in docker-compose.yml)
CMD ["node", \
     "--http", \
     "--http.addr=0.0.0.0", \
     "--http.port=8545", \
     "--http.api=eth,net,web3,admin", \
     "--authrpc.addr=0.0.0.0", \
     "--authrpc.port=8551", \
     "--datadir=/data/reth"]

